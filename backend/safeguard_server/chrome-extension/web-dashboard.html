<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SafeGuard Family - Dashboard</title>
  <link rel="stylesheet" href="/assets/dashboard.css">
  <style>
    /* Additional styles for web dashboard */
    .loading {
      text-align: center;
      padding: 40px;
      font-size: 18px;
      color: #718096;
    }
    .child-selector {
      margin: 20px 0;
      padding: 15px;
      background: #f7fafc;
      border-radius: 8px;
    }
    .child-selector select {
      width: 100%;
      padding: 10px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 16px;
    }
    .create-child-btn {
      margin-top: 10px;
      padding: 10px 20px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }
    .create-child-btn:hover {
      background: #5568d3;
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="brand-icon">üõ°Ô∏è</span>
      <div>
        <div class="brand-title">SafeGuard Family</div>
        <div class="brand-subtitle">Web Dashboard</div>
      </div>
    </div>
    <div class="user">
      <span id="parentEmail" class="parent-email">Loading...</span>
      <button id="logoutButton" class="btn btn-ghost">Logout</button>
    </div>
  </header>

  <main class="layout">
    <aside class="sidebar">
      <div class="child-card">
        <div class="child-label">Protected Child</div>
        <div class="child-name" id="childNameDisplay">Loading...</div>
        <div class="child-selector" id="childSelector" style="display: none;">
          <select id="childSelect"></select>
          <button class="create-child-btn" id="createChildBtn">Create New Child</button>
        </div>
      </div>

      <nav class="nav">
        <button class="nav-btn active" data-tab="overview">üìä Overview</button>
        <button class="nav-btn" data-tab="history">üßæ All Visits</button>
        <button class="nav-btn" data-tab="blocked">üö´ Blocked Sites</button>
        <button class="nav-btn" data-tab="usage">‚è±Ô∏è Usage & Limits</button>
        <button class="nav-btn" data-tab="lists">üìã Manage Lists</button>
      </nav>
    </aside>

    <section class="content">
      <!-- Overview -->
      <div class="tab active" id="overview">
        <h1>Overview</h1>
        <p class="subtitle">Monitor your child's online activity</p>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-icon">üõ°Ô∏è</div>
            <div class="stat-label">Total Blocked</div>
            <div class="stat-value" id="totalBlocked">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üìÖ</div>
            <div class="stat-label">Blocked Today</div>
            <div class="stat-value" id="todayBlocked">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üåê</div>
            <div class="stat-label">Total Visits</div>
            <div class="stat-value" id="totalVisits">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-label">Active Devices</div>
            <div class="stat-value" id="totalDevices">0</div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">
            <h2>Recent Activity</h2>
            <button id="refreshOverview" class="btn btn-ghost">Refresh</button>
          </div>
          <div class="table">
            <div class="table-row table-head">
              <div>Time</div>
              <div>URL</div>
              <div>Device</div>
              <div>Status</div>
            </div>
            <div id="recentActivityTable"></div>
          </div>
        </div>
      </div>

      <!-- All Visits -->
      <div class="tab" id="history">
        <h1>All Visits</h1>
        <p class="subtitle">Complete browsing history</p>

        <div class="toolbar">
          <input id="historySearch" class="input" type="text" placeholder="Search URL or domain...">
          <button id="refreshHistory" class="btn btn-secondary">Refresh</button>
        </div>

        <div class="table">
          <div class="table-row table-head">
            <div>Date & Time</div>
            <div>URL</div>
            <div>Device</div>
            <div>Duration</div>
          </div>
          <div id="historyTable"></div>
        </div>
      </div>

      <!-- Blocked Sites -->
      <div class="tab" id="blocked">
        <h1>Blocked Sites</h1>
        <p class="subtitle">Complete log of blocked attempts</p>

        <div class="toolbar">
          <input id="blockedSearch" class="input" type="text" placeholder="Search blocked URLs...">
          <select id="blockedCategory" class="select">
            <option value="">All Categories</option>
            <option value="Adult">Adult</option>
            <option value="Gambling">Gambling</option>
            <option value="Violence">Violence</option>
            <option value="Drugs">Drugs</option>
            <option value="Hate">Hate</option>
            <option value="Malware">Malware</option>
            <option value="Custom">Custom</option>
          </select>
          <button id="refreshBlocked" class="btn btn-secondary">Refresh</button>
        </div>

        <div class="table">
          <div class="table-row table-head">
            <div>Date & Time</div>
            <div>URL</div>
            <div>Category</div>
            <div>Device</div>
          </div>
          <div id="blockedTable"></div>
        </div>
      </div>

      <!-- Usage & Limits -->
      <div class="tab" id="usage">
        <h1>Usage & Limits</h1>
        <p class="subtitle">Daily usage by website with time limits</p>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-icon">‚è±Ô∏è</div>
            <div class="stat-label">Total Time Today</div>
            <div class="stat-value" id="totalTimeToday">0m</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üî•</div>
            <div class="stat-label">Top Site</div>
            <div class="stat-value" id="topSiteToday">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üß≠</div>
            <div class="stat-label">Sites Used</div>
            <div class="stat-value" id="sitesUsedToday">0</div>
          </div>
        </div>

        <div class="section">
          <div class="section-header">
            <h2>Per-Site Usage</h2>
            <button id="refreshUsage" class="btn btn-secondary">Refresh</button>
          </div>
          <div class="table">
            <div class="table-row table-head">
              <div>Domain</div>
              <div>Time Today</div>
              <div>Limit</div>
              <div>Status</div>
            </div>
            <div id="usageTable"></div>
          </div>
        </div>

        <div class="section">
          <h2>Set Time Limit</h2>
          <div style="display: grid; grid-template-columns: 1fr 140px 170px 100px; gap: 10px; margin-top: 10px;">
            <input id="limitDomain" class="input" type="text" placeholder="example.com">
            <input id="limitMinutes" class="input" type="number" min="0" step="5" placeholder="Minutes">
            <label class="toggle" style="margin: 0;">
              <input type="checkbox" id="limitPermanent">
              <span>Permanent Block</span>
            </label>
            <button id="addLimit" class="btn btn-primary">Save</button>
          </div>
          <div id="limitsList" style="margin-top: 20px;"></div>
        </div>
      </div>

      <!-- Manage Lists -->
      <div class="tab" id="lists">
        <h1>Manage Lists</h1>
        <p class="subtitle">Block or allow specific websites</p>

        <div class="section">
          <h2>Block Custom Domain</h2>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <input id="blockDomain" class="input" type="text" placeholder="example.com" style="flex: 1;">
            <select id="blockCategory" class="select">
              <option value="Custom">Custom</option>
              <option value="Adult">Adult</option>
              <option value="Gambling">Gambling</option>
              <option value="Violence">Violence</option>
            </select>
            <button id="addBlock" class="btn btn-primary">Add Block</button>
          </div>
          <div id="blocklist" style="margin-top: 20px;"></div>
        </div>

        <div class="section" style="margin-top: 30px;">
          <h2>Allow Trusted Domain</h2>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <input id="allowDomain" class="input" type="text" placeholder="khanacademy.org" style="flex: 1;">
            <button id="addAllow" class="btn btn-primary">Add Allow</button>
          </div>
          <div id="allowlist" style="margin-top: 20px;"></div>
        </div>
      </div>
    </section>
  </main>

  <script src="/assets/web-dashboard.js"></script>
</body>
</html>
